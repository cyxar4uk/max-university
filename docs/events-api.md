# Контракт API мероприятий (ивенты) для интеграции с MAX

В MAX мероприятия отображаются в виджетах на Главной и в Хабе. Данные берутся из внешнего API проекта ивентов; виджеты показывают краткую информацию и ссылку «Открыть в боте».

## Переменные окружения на стороне MAX

- **EVENTS_API_URL** — базовый URL API ивентов (например, `https://events.example.com/api`). Если не задан, виджет показывает заглушку и ссылку на бота.
- **EVENTS_BOT_LINK** — ссылка на бота (по умолчанию `https://t.me/events_bot`).

## Ожидаемый контракт API ивентов

### Эндпоинт: список мероприятий

- **Метод**: `GET /events` (или эквивалент по вашему базовому URL).
- **Параметры запроса** (рекомендуется):
  - `limit` (optional) — количество записей (по умолчанию MAX запрашивает 10).

### Формат ответа

Вариант 1 — массив мероприятий:

```json
[
  {
    "id": "evt_1",
    "title": "Название мероприятия",
    "name": "Название мероприятия",
    "date": "2025-12-01T18:00:00",
    "location": "Актовый зал",
    "registration_status": "open"
  }
]
```

Вариант 2 — объект с полями:

```json
{
  "events": [ ... ],
  "bot_link": "https://t.me/events_bot"
}
```

Рекомендуемые поля для карточки в виджете:

| Поле | Тип | Описание |
|------|-----|----------|
| id | string/number | Уникальный идентификатор |
| title или name | string | Название мероприятия |
| date | string (ISO 8601) | Дата и время |
| location | string | Место проведения |
| registration_status | string | Статус регистрации (например, open, closed, my_registration) |

### Прокси в MAX

Backend MAX вызывает ваш API и отдаёт фронту:

- `events` — массив мероприятий;
- `bot_link` — ссылка на бота (из ответа или `EVENTS_BOT_LINK`).

## Вопросы к проекту ивентов (для уточнения контракта)

1. **Авторизация**
   - Как идентифицировать пользователя MAX в API ивентов (user_id, telegram_id, токен)?
   - Нужен ли отдельный API-ключ для запросов из MAX (backend-to-backend или с фронта)?

2. **Эндпоинты для виджетов**
   - Список ближайших/актуальных мероприятий: один метод `GET /events` или отдельно «рекомендованные», «по дате», «мои»?
   - Нужен ли эндпоинт «мои регистрации» / «мои мероприятия» (статус участия пользователя)?
   - Какие поля обязательны в ответе для карточки в виджете?

3. **Формат ответа**
   - JSON: фиксированный набор полей или расширяемый?
   - Пагинация (limit/offset или cursor) для списка мероприятий?

4. **Ссылка на бота**
   - Один общий URL бота для всех виджетов или отдельная ссылка на конкретное мероприятие (deep link)? Если deep link — какой формат (например, `https://t.me/events_bot?start=event_123`)?

5. **Ограничения**
   - Лимиты по RPS для запросов из MAX?
   - Нужен ли кеш на стороне MAX (и если да, какой TTL)?

После согласования ответов контракт можно зафиксировать в этом документе (примеры запроса/ответа, заголовки, коды ошибок).
